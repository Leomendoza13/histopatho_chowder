# Report

## Article understanding

The article titled "Classification and Disease Localization in Histopathology Using Only Global Labels: A Weakly-Supervised Approach" authored by Pierre Courtiol, Eric W. Tramel, Marc Sanselme, and Gilles Wainrib from Owkin, Inc., New York City, delves into histopathology, which involves diagnosing and studying tissue diseases by examining them under a microscope. Specifically, the focus is on oncology histopathology.

### Introduction

Histopathological image analysis (HIA) serves as the  gold standard in oncology deep learning. However, its high cost is due to the fact that pathologists must analyse pixel by pixel segmentation maps of diseased tissue at extreme resolution to create annotations.
As a result, HIA datesets are often small, leading to weakly supervised learning methods due to limited ressources. 
The Chowder model introduced in this study addresses this challenge by using features generated by a ResNet50 as inputs.
Multiple Instance Learning (MIL) is employed here because whole slide images (WSI) are commonly processed digitally in tiles. The aggregation of these tiles into groups with a single label ("healthy" or "cancer present") assumes that the slide is considered to have "cancer present" if one or more tiles are labeled as such.

### WSI pre-processing

During pre-processing, only tiles within the foreground segmentation are extracted for training purposes. Additionally, color normalization is performed to account for variations in staining between slides. Finally, the process of tiling is implemented. The study employs the ResNet-50 architecture, which has been trained on the ImageNet natural image dataset, with a feature vector of dimensionality p=2048 floating-point values for each tile.

### Method

For the baseline method, MaxPooling and mean pooling techniques are employed to obtain a single feature descriptor representing the entire image. Following the aggregation, a classifier is trained to generate the desired diagnosis labels. In this case, a logistic regression model is used for the final prediction layer of the model. This method is not accurate for diffuse disease. Here, diffuse implies that the number of disease-containing tiles, pertinent to the diagnosis label, are roughly proportional
to the number of tiles containing healthy tissue.

![alt text](imgs/figure1.png)

The Chowder method, which is the principal point of interest, draws inspiration from the WELDON architecture. Similar to the baseline approach, the features generated by ResNet-50 are used by Chowder. However, Chowder employs a convolution operation on the local descriptor to transform it into an number of tiles√ó1 vector. This vector is then sorted by value, and only the maximum and minimum values are retained. The number of retain value depends on the parameter (2 on figure2). These values represent the tiles with the highest and lowest probabilities of disease presence, respectively. As a result, these values are inserted into a Multi-Layer Perceptron (MLP) classifier, which outputs the probability that the slide contains the disease.

![alt text](imgs/figure2.png)

## Experimental results

### Training Details

To address overfitting, strong regularization techniques are employed in the Chowder method. An L2 regularization of 0.5 is applied on the convolution feature embedding layer, and dropout with a rate of 0.5 is used on the MLP. Training is conducted using the Adam optimizer to minimize the binary cross-entropy loss over 30 epochs, with a mini-batch size of 10 and a learning rate of 0.001.
To reduce variance and prevent overfitting, an ensemble of E Chowder networks is trained, each differing only by their initial weights. The final prediction is established by averaging the predictions made by these E networks. For Table S1, E is set to 10, while for the Camelyon-16 leaderboards, E is set to 50 with R = 5. E is set to 10 for the WELDON results.
There are two challenges. 
The first challenge, TCGA, provides 11,000 tissue slide images of cancers from various organs. The study focuses on 707 lung cancer slides (TCGA-lung), predicting whether each slide contains adenocarcinoma or squamous cell carcinoma. Classification quality is evaluated based on the area under the curve (AUC) of the receiver operating characteristic (ROC) curve generated using the raw output predictions. 
The second challenge, Camelyon-16, provides labeling and segmentation masks for each WSI, representing expert analysis on the location of metastases within the slide. Only diagnosis labels are used, and the segmentation masks are set aside. Evaluation of the Camelyon-16 dataset is conducted on two axes, the accuracy of the predicted label for each wsi based on AUC and the accuracy of metastasis localization, evaluated by comparing model outputs to the ground-truth expert annotations of metastasis location using free ROC metric (FROC).

Here are the results:

![alt text](imgs/results.png)

![alt text](imgs/figure4.png)

The study has demonstrated that leveraging state-of-the-art techniques from Multiple Instance Learning (MIL) in computer vision, allows for the construction of an effective technique for both diagnosis prediction and disease location within Whole Slide Images (WSI) in histopathology, all without the requirement of expensive localized annotations produced by expert pathologists.

However, there remains improvements in the CHOWDER method, particularly in the generation of disease localization maps.